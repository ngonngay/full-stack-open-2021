(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{40:function(e,n,t){},42:function(e,n,t){"use strict";t.r(n);var c=t(2),o=t(16),a=t.n(o),r=t(4),u=t(3),s=t.n(u),i="/api/persons",l=function(){return s.a.get(i)},d=function(e){return s.a.post("".concat(i,"/create"),e)},m=function(e){return s.a.delete("".concat(i,"/").concat(e))},b=function(e,n){return s.a.put("".concat(i,"/").concat(e),n)},h=t(17),j=(t(40),t(0)),f=function(e){var n=e.handleFilter,t=e.value;return Object(j.jsxs)("div",{children:["filter show with ",Object(j.jsx)("input",{onChange:n,value:t})]})},p=function(e){var n=e.handleSubmit,t=e.setNewName,c=e.setNewNumber,o=e.newName,a=e.newNumber;return Object(j.jsxs)("form",{onSubmit:n,children:[Object(j.jsxs)("div",{children:["name:",Object(j.jsx)("input",{onChange:t,value:o,required:!0}),Object(j.jsxs)("div",{children:["number:",Object(j.jsx)("input",{onChange:c,value:a,required:!0})]})]}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{type:"submit",children:"add"})})]})},g=function(e){var n=e.message;return null===n.message?null:Object(j.jsx)("div",{className:n.type,children:n.message})},O=function(){var e=Object(c.useState)([]),n=Object(r.a)(e,2),t=n[0],o=n[1],a=Object(c.useState)(""),u=Object(r.a)(a,2),s=u[0],i=u[1],O=Object(c.useState)(""),v=Object(r.a)(O,2),w=v[0],x=v[1],N=Object(c.useState)(""),y=Object(r.a)(N,2),S=y[0],k=y[1],C=Object(c.useState)({message:null}),T=Object(r.a)(C,2),U=T[0],A=T[1];Object(c.useEffect)((function(){l().then((function(e){console.log(e.data.phones),o(e.data.phones)})).catch((function(e){console.log(e)}))}),[]);return Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{children:"Phonebook"}),Object(j.jsx)(g,{message:U}),Object(j.jsx)(f,{handleFilter:function(e){return k(e.target.value)},value:S}),Object(j.jsx)("h1",{children:"Add a new phone"}),Object(j.jsx)(p,{handleSubmit:function(e){return function(e){if(e.preventDefault(),function(e,n){return e.map((function(e){return e.name})).includes(n.trim())}(t,s)){var n=window.confirm("".concat(s," is already added to phonebook,replace the old number with the new one?")),c=-1;n&&(t.forEach((function(e){e.name===s&&(c=e.id)})),-1!=c&&(console.log(c),b(c,{name:s.trim(),number:w.trim()}).then((function(e){e.data.succeed?(A({message:"Updated number for ".concat(s),type:"succeed"}),setTimeout((function(){A({message:null})}),5e3),i(""),x(""),l().then((function(e){o(e.data.phones)}))):(console.log(e.data),A({message:"Updated number for ".concat(s," failed! Try again or refresh the page"),type:"error"}))}))))}else d({name:s.trim(),number:w.trim()}).then((function(e){console.log(e),console.log(e.data.savedPhone.id),o(t.concat({id:e.data.savedPhone.id,name:s.trim(),number:w})),A({message:"Added ".concat(s),type:"succeed"}),setTimeout((function(){A({message:null})}),5e3),i(""),x("")})).catch((function(e){console.log({error:e}),A({message:"$error",type:"error"})}))}(e)},setNewName:function(e){return i(e.target.value)},setNewNumber:function(e){return x(e.target.value)},newName:s,newNumber:w}),Object(j.jsx)("h2",{children:"Numbers"}),t.filter((function(e){return e.name.toUpperCase().includes(S.toUpperCase())})).map((function(e){return Object(j.jsxs)("p",{children:["".concat(e.name,"  ").concat(e.number)," ",Object(j.jsx)("button",{onClick:function(){return function(e,n){var t=window.confirm("Are you sure you want to delete this?");console.log(e),t&&m(e).then((function(e){e.data.succeed&&(l().then((function(e){o(e.data.phones)})),A({message:"Deleted ".concat(n),type:"succeed"}),setTimeout((function(){A({message:null})}),5e3))})).catch((function(e){A({message:"".concat(e),type:"error"}),setTimeout((function(){A({message:null})}),5e3)}))}(e.id,e.name)},children:"Delete"})," "]},Object(h.a)())}))]})};a.a.render(Object(j.jsx)(O,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.539b9e1d.chunk.js.map